<!DOCTYPE html>
<html>
<head>
    <title>Create Post via REST API</title>
</head>
<body>
    <h1>Create a New Post</h1>

    <form id="postForm">
        <label>Title:</label>
        <input type="text" id="title" name="title"><br><br>

        <label>Content:</label>
        <textarea id="content" name="content"></textarea><br><br>

        <label>Tags (comma separated):</label>
        <input type="text" id="tags" name="tags"><br><br>

        <label>Media URL (optional):</label>
        <input type="text" id="mediaUrl" name="mediaUrl"><br><br>

        <input type="submit" value="Create Post">
    </form>

    <div id="response" style="margin-top: 20px;"></div>

    <script>
        const form = document.getElementById('postForm');
        form.addEventListener('submit', async function(event) {
            event.preventDefault();

            const title = document.getElementById('title').value;
            const content = document.getElementById('content').value;
            const tags = document.getElementById('tags').value.split(',');
            const mediaUrl = document.getElementById('mediaUrl').value;

            const postData = {
                userId: "123456", // Hardcoded for testing; eventually youâ€™ll get this from login
                title,
                content,
                tags,
                mediaUrls: mediaUrl ? [mediaUrl] : []
            };

            const responseDiv = document.getElementById('response');

            try {
                const res = await fetch('http://localhost:9090/api/posts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(postData)
                });

                if (res.ok) {
                    const data = await res.json();
                    responseDiv.innerHTML = `<p style="color: green;">Post created with ID: ${data.id}</p>`;
                } else {
                    const error = await res.text();
                    responseDiv.innerHTML = `<p style="color: red;">Failed: ${error}</p>`;
                }
            } catch (err) {
                responseDiv.innerHTML = `<p style="color: red;">Error: ${err.message}</p>`;
            }
        });
    </script>
</body>
</html>
